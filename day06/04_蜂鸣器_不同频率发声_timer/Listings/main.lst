C51 COMPILER V9.60.7.0   MAIN                                                              06/29/2024 09:41:54 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: D:\AppData\Keil_v5\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listi
                    -ngs\main.lst) TABS(2) OBJECT(.\Objects\main.obj)

line level    source

   1          #include "Config.h"
   2          #include "Delay.h"
   3          #include "GPIO.h"
   4          #include "NVIC.h"
   5          #include "Timer.h"
   6          
   7          
   8          #define BuzzerPin P00
   9          
  10          //       C`    D`     E`   F`   G`  A`    B` C``
  11          u16 hz[] = {1047, 1175, 1319, 1397, 1568, 1760, 1976, 2093};
  12          
  13          // 初始化蜂鸣器GPIO
  14          void gpio_config(void) {
  15   1        // 初始化NPN S8050的控制引脚 - P00
  16   1        P0_MODE_OUT_PP(GPIO_Pin_0); // 推挽输出
  17   1      }
  18          
  19          // 初始化定时器timer0
  20          void Timer_config(u16 hz) {
  21   1        TIM_InitTypeDef TIM_InitStructure; // 结构定义
  22   1        // 定时器0做16位自动重装, 中断频率为1000HZ
  23   1        TIM_InitStructure.TIM_Mode =
  24   1            TIM_16BitAutoReload; // 指定工作模式,
  25   1                                 // TIM_16BitAutoReload,TIM_16Bit,TIM_8BitAutoReload,TIM_16BitAutoReloadNoMask
  26   1        TIM_InitStructure.TIM_ClkSource =
  27   1            TIM_CLOCK_1T; // 指定时钟源,     TIM_CLOCK_1T,TIM_CLOCK_12T,TIM_CLOCK_Ext
  28   1        TIM_InitStructure.TIM_ClkOut = DISABLE; // 是否输出高速脉冲, ENABLE或DISABLE
  29   1        TIM_InitStructure.TIM_Value = 65536UL - (MAIN_Fosc / hz * 2); // 初值,
  30   1        TIM_InitStructure.TIM_Run = ENABLE; // 是否初始化后启动定时器, ENABLE或DISABLE
  31   1        Timer_Inilize(Timer0,
  32   1                      &TIM_InitStructure); // 初始化Timer0
  33   1                                           // Timer0,Timer1,Timer2,Timer3,Timer4
  34   1        NVIC_Timer0_Init(ENABLE,
  35   1                         Priority_0); // 中断使能, ENABLE/DISABLE; 优先级(低到高)
  36   1                                      // Priority_0,Priority_1,Priority_2,Priority_3
  37   1      }
  38          
  39          void time_call(void) {
  40   1        // 每一个时钟时间颠倒一次蜂鸣器的电平
  41   1        BuzzerPin = ~BuzzerPin;
  42   1      }
  43          
  44          int main() {
  45   1        u8 idx = 0;
  46   1      
  47   1        gpio_config();
  48   1        EA = 1;
  49   1      
  50   1        while (1) {
  51   2          Timer_config(hz[idx]);
  52   2      
  53   2          if (++idx > 7) // 先++再判断，当其值大于7时将其恢复为0
  54   2          {
C51 COMPILER V9.60.7.0   MAIN                                                              06/29/2024 09:41:54 PAGE 2   

  55   3            idx = 0;
  56   3          }
  57   2          delay_ms(250);
  58   2          delay_ms(250);
  59   2          delay_ms(250);
  60   2          delay_ms(250);
  61   2        }
  62   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    130    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     16       8
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
