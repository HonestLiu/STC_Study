C51 COMPILER V9.60.7.0   MAIN                                                              06/14/2024 09:26:35 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: D:\AppData\Keil_v5\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listi
                    -ngs\main.lst) OBJECT(.\Objects\main.obj)

line level    source

   1          #include "reg51.h"
   2          #include "intrins.h"
   3          
   4          /*设置波特率的*/
   5          sfr     T2L     =   0xd7;
   6          sfr     T2H     =   0xd6;
   7          sfr     AUXR    =   0x8e;
   8          
   9          sfr     P0M1    =   0x93;
  10          sfr     P0M0    =   0x94;
  11          sfr     P1M1    =   0x91;
  12          sfr     P1M0    =   0x92;
  13          sfr     P2M1    =   0x95;
  14          sfr     P2M0    =   0x96;
  15          sfr     P3M1    =   0xb1;
  16          sfr     P3M0    =   0xb2;
  17          sfr     P4M1    =   0xb3;
  18          sfr     P4M0    =   0xb4;
  19          sfr     P5M1    =   0xc9;
  20          sfr     P5M0    =   0xca;
  21          sfr             P5              =       0xc8;//P5寄存器基地址
  22          
  23          sbit    P10     =   P1^0;
  24          sbit    P11     =   P1^1;
  25          sbit    P53             =       P5^3;//P5寄存器从左往右数第3位，对应的就是P53
  26          
  27          void UART1_Isr() interrupt 4
  28          {
  29   1          if (TI)//如果寄存器TI触发中断，关闭灯
  30   1          {
  31   2                      // TI位为发送数据后收到置1的
  32   2              TI = 0;                                 //清中断标志
  33   2              P53 = 0;                                //关闭灯
  34   2          }
  35   1          if (RI)//如果接收寄存器RI触发了中断，打开灯
  36   1          {
  37   2                      //RI位是接收到数据系统自动置1的，这里需要手动清除中断标记
  38   2              RI = 0;                                 //清中断标志
  39   2              P53 = 1;                             //打开灯
  40   2          }
  41   1      }
  42          
  43          /*延时函数-ISP生成*/
  44          void Delay1000ms(void)  //@11.0592MHz
  45          {
  46   1              unsigned char data i, j, k;
  47   1      
  48   1              i = 57;
  49   1              j = 27;
  50   1              k = 112;
  51   1              do
  52   1              {
  53   2                      do
  54   2                      {
C51 COMPILER V9.60.7.0   MAIN                                                              06/14/2024 09:26:35 PAGE 2   

  55   3                              while (--k);
  56   3                      } while (--j);
  57   2              } while (--i);
  58   1      }
  59          
  60          
  61          void main()
  62          {
  63   1              //初始化端口为双向输出模式
  64   1          P0M0 = 0x00;
  65   1          P0M1 = 0x00;
  66   1          P1M0 = 0x00;
  67   1          P1M1 = 0x00;
  68   1          P2M0 = 0x00;
  69   1          P2M1 = 0x00;
  70   1          P3M0 = 0x00;
  71   1          P3M1 = 0x00;
  72   1          P4M0 = 0x00;
  73   1          P4M1 = 0x00;
  74   1          P5M0 = 0x00;
  75   1          P5M1 = 0x00;
  76   1      
  77   1          SCON = 0x50;                                                                //SM1 设置模式1 及 REN 串口接收控制位 (0x40 | 0x10) 将前面两个位
             -都置1了
  78   1          T2L = 0xe8;                                 //65536-11059200/115200/4=0FFE8H，计数值
  79   1          T2H = 0xff;
  80   1          AUXR = 0x15;                                //启动定时器
  81   1          ES = 1;                                     //使能串口1的中断
  82   1          EA = 1;                                                                             //使能中断总开关
  83   1      
  84   1              P53 = 1;                                                                        //开始先把灯打开(很快就会被熄灭)
  85   1              
  86   1          while (1)
  87   1              {
  88   2                      //休眠1S
  89   2                      Delay1000ms();
  90   2                      
  91   2                      //发送测试数据0x23->"#"
  92   2                      SBUF = 0x23;
  93   2                      
  94   2                      //将TI位置1，标记发送数据
  95   2                      TI = 1;
  96   2              }
  97   1      }
  98          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     81    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
