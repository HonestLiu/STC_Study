C51 COMPILER V9.60.7.0   MAIN                                                              06/14/2024 19:51:13 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: D:\AppData\Keil_v5\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listi
                    -ngs\main.lst) OBJECT(.\Objects\main.obj)

line level    source

   1          /**
   2           * @author HonestLiu
   3           * @note 通过定时器每1ms调整一次LED灯的亮灭,定时器回调函数逻辑在"Timer_lsr.c"的Ti
             -mer0_ISR_Handler中进行定义
   4           **/
   5          #include "Config.h"
   6          #include "GPIO.h"
   7          #include "Timer.h"
   8          #include "NVIC.h"
   9          
  10          /* LED引脚初始化函数->P53 */
  11          void gpio_config(void)
  12          {
  13   1          GPIO_InitTypeDef gpio_struct;
  14   1          gpio_struct.Pin = GPIO_Pin_3;
  15   1          gpio_struct.Mode = GPIO_PullUp; // 上拉准双向口
  16   1          GPIO_Inilize(GPIO_P5, &gpio_struct);
  17   1      }
  18          
  19          /* 定时器初始化函数-Timer0 */
  20          void timer_init(void)
  21          {
  22   1          TIM_InitTypeDef tim_struct;
  23   1          tim_struct.TIM_Mode = TIM_16BitAutoReload;                     // 16位自动重装载模式
  24   1          tim_struct.TIM_ClkSource = TIM_CLOCK_1T;                       // 时钟源为1T
  25   1          tim_struct.TIM_ClkOut = DISABLE;                                       // 不输出高数脉冲
  26   1          tim_struct.TIM_Value = 65536UL - (MAIN_Fosc / 1000UL); // 初值
  27   1          tim_struct.TIM_Run = ENABLE;                                                   // 是否初始化后启动定时器
  28   1          Timer_Inilize(Timer0, &tim_struct);
  29   1      
  30   1          NVIC_Timer0_Init(ENABLE, Priority_0); // 中断使能, ENABLE/DISABLE; 优先级(低到高) Priority_0
             -,Priority_1,Priority_2,Priority_3
  31   1      }
  32          
  33          /*定时器回调逻辑->每次定时器溢出都会调用*/
  34          int count = 0;
  35          void tim0_call(void)
  36          {
  37   1          /*让P53灯每500ms切换一次亮灭*/
  38   1          count++;
  39   1          if(count == 500)//回调函数每1ms被调用一次，使用变量计数，当变量满500时切换LED
             -引脚状态
  40   1          {
  41   2              P53 = ~P53;
  42   2          }
  43   1      }
  44          
  45          int main()
  46          {
  47   1          gpio_config();
  48   1          timer_init();
  49   1          EA = 1;      // 开启全局中断
  50   1          P53 = 0; // 先关闭P53LED
  51   1      
C51 COMPILER V9.60.7.0   MAIN                                                              06/14/2024 19:51:13 PAGE 2   

  52   1          while (1)
  53   1              ;
  54   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     80    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      2       9
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
